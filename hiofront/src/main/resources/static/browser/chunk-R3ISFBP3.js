import"./chunk-BYXBJQAS.js";import{a as Ce,b as Re,c as Te,d as Ie,e as Me,f as Le,g as we,h as xe,i as De,j as be,k as Ae,l as Ne,q as H,r as Oe,s as Fe}from"./chunk-MX3EZ4PD.js";import{w as ve}from"./chunk-PDR5UM57.js";import{a as $,b as ge,c as V,d as J}from"./chunk-PLDY3HMN.js";import{A as Se,B as k,p as fe,q as g,r as F,t as Ue,u as Ee,v as he,y as ye,z as P}from"./chunk-ERJNKWX5.js";import{$ as x,$a as f,Bb as h,D as c,Ja as o,Kb as oe,Lb as se,Na as Z,Sa as A,Ta as N,Wa as U,X as y,_a as p,a as R,aa as D,ac as ne,b as T,bc as ae,ca as W,da as b,dc as me,ec as le,fb as n,gb as a,gc as pe,hb as Q,ib as S,ic as ce,jb as v,la as u,lb as O,ma as _,n as I,nb as E,ob as m,qc as de,r as M,rb as ee,t as L,ta as X,tb as te,tc as ue,ub as re,uc as _e,v as w,vb as ie,vc as q,zb as d}from"./chunk-V72LI5IB.js";var ot=g("[User] Get User list"),Pe=g("[User] Set User list",F()),ke=g("[User] Modify User (STATE)",F()),$e=g("[User] Delete User (STATE)",F());var je=he("usersState"),Ve=()=>Ee(je,r=>r.users);function Ge(r,t){if(r&1&&(n(0,"th",10),d(1),a()),r&2){let e=m().$implicit;f("font-size","1.6vw")("font-family","white_storm"),ee("mat-sort-header",e.fieldName),o(),h(" ",e.header," ")}}function Qe(r,t){if(r&1&&(n(0,"td",11),d(1),a()),r&2){let e=t.$implicit,i=m().$implicit;f("font-size","1.6vw")("font-family","cardinal"),o(),h(" ",e[i.fieldName]," ")}}function qe(r,t){if(r&1&&(S(0,7),U(1,Ge,2,6,"th",8)(2,Qe,2,5,"td",9),v()),r&2){let e=t.$implicit;p("matColumnDef",e.fieldName)}}function Je(r,t){r&1&&(n(0,"th",12),d(1," Actions "),a()),r&2&&f("font-size","1.6vw")("font-family","white_storm")}function Ke(r,t){if(r&1){let e=O();n(0,"td",11)(1,"button",13),E("click",function(){let s=u(e).$implicit,l=m();return _(l.selectUser(s,6))}),d(2),a(),n(3,"button",13),E("click",function(){let s=u(e).$implicit,l=m();return _(l.selectUser(s,4))}),d(4),a(),n(5,"button",13),E("click",function(){let s=u(e).$implicit,l=m();return _(l.selectUser(s,5))}),d(6),a(),n(7,"button",13),E("click",function(){let s=u(e).$implicit,l=m();return _(l.selectUser(s,1))}),d(8," Delete "),a()()}if(r&2){let e=t.$implicit;o(),f("font-size","1.6vw")("font-family","cardinal"),o(),h(" ",e.role==="ROLE_ADMIN"?"to User":"to Admin"," "),o(),f("font-size","1.6vw")("font-family","cardinal"),o(),h(" ",e.role==="ROLE_BANNED"?"Unblock":"Block"," "),o(),f("font-size","1.6vw")("font-family","cardinal"),o(),h(" ",e.role==="ROLE_MUTED"?"Unmute":"Mute"," "),o(),f("font-size","1.6vw")("font-family","cardinal")}}function We(r,t){r&1&&Q(0,"tr",14)}function Xe(r,t){r&1&&Q(0,"tr",15)}var z=class r{constructor(){this.headers=[];this._users=[];this.event=new X;this.dataSource=new Ae;this.eventNamesFields=[]}set users(t){this._users=t,this.dataSource.data=[...t]}get users(){return this._users}ngOnInit(){this.getHeaderFields()}ngAfterViewInit(){this.dataSource.sort=this.sort}getHeaderFields(){this.eventNamesFields=this.headers.map(t=>t.fieldName),this.eventNamesFields.push("actions")}selectUser(t,e){this.event.emit({user:t,action:e})}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=A({type:r,selectors:[["app-users-list"]],viewQuery:function(e,i){if(e&1&&te(H,5),e&2){let s;re(s=ie())&&(i.sort=s.first)}},inputs:{headers:"headers",users:"users"},outputs:{event:"event"},standalone:!1,decls:7,vars:4,consts:[["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","",3,"font-size","font-family",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["mat-header-cell","",3,"mat-sort-header","font-size","font-family",4,"matHeaderCellDef"],["mat-cell","",3,"font-size","font-family",4,"matCellDef"],["mat-header-cell","",3,"mat-sort-header"],["mat-cell",""],["mat-header-cell",""],["mat-raised-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,i){e&1&&(n(0,"table",0),U(1,qe,3,1,"ng-container",1),S(2,2),U(3,Je,2,4,"th",3)(4,Ke,9,19,"td",4),v(),U(5,We,1,0,"tr",5)(6,Xe,1,0,"tr",6),a()),e&2&&(p("dataSource",i.dataSource),o(),p("ngForOf",i.headers),o(4),p("matHeaderRowDef",i.eventNamesFields),o(),p("matRowDefColumns",i.eventNamesFields))},dependencies:[ne,ve,Ce,Te,we,Ie,Re,xe,Me,Le,De,be,H,Oe],encapsulation:2})}};function tt(r,t){if(r&1){let e=O();S(0),n(1,"app-users-list",1),E("event",function(s){u(e);let l=m();return _(l.selectUser(s))}),a(),v()}if(r&2){let e=t.ngIf,i=m();o(),p("users",e)("headers",i.headers)}}var j=class r{constructor(t){this.store=t;this.headers=[{header:"id",fieldName:"id"},{header:"username",fieldName:"username"},{header:"email",fieldName:"email"},{header:"city",fieldName:"city"},{header:"about",fieldName:"about"},{header:"eventsAmount",fieldName:"eventsAmount"},{header:"role",fieldName:"role"}];this.users=[];this.users$=this.store.select(Ve())}ngOnInit(){this.store.dispatch({type:"[User] Get User list"})}selectUser(t){switch(t.action){case 6:{let e=structuredClone(t.user);t.user.role!=="ROLE_ADMIN"?e.role="ROLE_ADMIN":e.role="ROLE_USER",this.store.dispatch({type:"[User] Modify User (API)",payload:e});return}case 4:{let e=structuredClone(t.user);t.user.role!=="ROLE_BANNED"?e.role="ROLE_BANNED":e.role="ROLE_USER",this.store.dispatch({type:"[User] Modify User (API)",payload:e});return}case 5:{let e=structuredClone(t.user);t.user.role!=="ROLE_MUTED"?e.role="ROLE_MUTED":e.role="ROLE_USER",this.store.dispatch({type:"[User] Modify User (API)",payload:e});return}case 1:{this.store.dispatch({type:"[User] Delete User (API)",payload:t.user});return}default:}}static{this.\u0275fac=function(e){return new(e||r)(Z(Ue))}}static{this.\u0275cmp=A({type:r,selectors:[["app-users-list-page"]],standalone:!1,decls:3,vars:3,consts:[[4,"ngIf"],[3,"event","users","headers"]],template:function(e,i){e&1&&(n(0,"body"),U(1,tt,2,2,"ng-container",0),oe(2,"async"),a()),e&2&&(o(),p("ngIf",se(2,1,i.users$)))},dependencies:[ae,z,me],styles:["body[_ngcontent-%COMP%]{min-height:100vh;width:100%;background-image:url(/assets/png/sire.png);background-blend-mode:overlay;background-size:43vw 40vw;background-repeat:no-repeat;background-attachment:fixed;background-position:center;background-position-y:87%}"]})}};var K=[{path:"",children:[{path:"",component:j}]}],Y=class r{static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275mod=N({type:r})}static{this.\u0275inj=D({imports:[q.forChild(K),q]})}};var rt={users:[]},He=Se(rt,P(Pe,(r,{users:t})=>T(R({},r),{users:t})),P(ke,(r,{user:t})=>T(R({},r),{users:r.users.map(e=>e.id===t.id?t:e)})),P($e,(r,{userId:t})=>T(R({},r),{users:r.users.filter(e=>e.id.toString()!=t)})));var B=class r{constructor(t){this.http=t}getUsers(){return this.http.get(`${k.usersURL}`).pipe(y(t=>(console.log(t),t)),c(t=>M(()=>t)))}patchUser(t,e){return console.log(e),this.http.patch(`${k.usersURL}/${t}`,e).pipe(c(i=>M(()=>i)))}deleteUser(t){return this.http.delete(`${k.usersURL}/${t}`).pipe(c(e=>M(()=>e)))}static{this.\u0275fac=function(e){return new(e||r)(W(pe))}}static{this.\u0275prov=x({token:r,factory:r.\u0275fac,providedIn:"root"})}};var G=class r{constructor(){this.actions$=b(ge);this.usersService=b(B);this.router=b(de);this.getUsers$=$(()=>this.actions$.pipe(V("[User] Get User list"),w(()=>this.usersService.getUsers().pipe(L(t=>({type:"[User] Set User list",users:t})),c(()=>I)))),{dispatch:!0});this.patchUser$=$(()=>this.actions$.pipe(V("[User] Modify User (API)"),w(t=>this.usersService.patchUser(t.payload.id,t.payload).pipe(L(e=>({type:"[User] Modify User (STATE)",user:t.payload})),y(()=>this.router.navigate(["users"])),c(()=>I)))),{dispatch:!0});this.deleteUser$=$(()=>this.actions$.pipe(V("[User] Delete User (API)"),w(t=>this.usersService.deleteUser(t.payload.id).pipe(L(()=>({type:"[User] Delete User (STATE)",eventId:t.payload})),y(()=>this.router.navigate(["users"])),c(()=>I)))),{dispatch:!0})}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=x({token:r,factory:r.\u0275fac})}};var ze=class r{static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275mod=N({type:r})}static{this.\u0275inj=D({providers:[ue(K,_e()),ce()],imports:[le,Y,fe,Fe,Ne,ye.forFeature("usersState",He),J.forFeature([G]),J.forRoot([])]})}};export{ze as UsersModule};
