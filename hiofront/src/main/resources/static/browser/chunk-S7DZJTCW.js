import{a as Ne,b as Be}from"./chunk-4YBTQDPN.js";import{b as Ve}from"./chunk-MZRYC2F6.js";import"./chunk-NAJAWU72.js";import{a as we,b as Pe,c as be,d as Ie,e as Me,f as Te,g as Oe,h as ke,i as Re,j as De,s as Fe}from"./chunk-MX3EZ4PD.js";import{w as xe}from"./chunk-PDR5UM57.js";import{a as ee,b as Se,c as te,d as ie}from"./chunk-PLDY3HMN.js";import{A as he,B as Z,p as ge,q as I,r as Q,t as N,u as W,v as ye,y as Ee,z as X}from"./chunk-ERJNKWX5.js";import{$ as M,$a as w,Ab as ce,Bb as b,D as E,Ja as n,Kb as pe,Lb as me,Na as u,Sa as h,Ta as k,W as re,Wa as m,X as q,_a as o,a as H,aa as T,ab as R,ac as D,b as z,bc as F,ca as ae,da as O,dc as le,ec as de,fb as a,gb as s,gc as fe,hb as P,ib as _,ic as ve,j as oe,jb as y,la as d,lb as g,ma as f,n as U,nb as v,ob as c,oc as Ce,qc as x,r as L,t as J,ta as se,tc as ue,uc as _e,v as Y,vc as K,zb as l}from"./chunk-V72LI5IB.js";var gt=I("[City] Get Cities"),$e=I("[City] Set Cities",Q()),Ct=I("[Event] Get Events"),je=I("[Event] Set Events",Q());var Ge=ye("citiesState"),Ae=()=>W(Ge,e=>e.cities),He=()=>W(Ge,e=>e.events);function Qe(e,i){if(e&1){let t=g();a(0,"div",4)(1,"p",5),v("click",function(){let p=d(t).$implicit,C=c();return f(C.selectCity(p))}),l(2),s()()}if(e&2){let t=i.$implicit;n(2),b("\u22C6\u0F3A",t,"\u0F3B\u22C6")}}function We(e,i){if(e&1){let t=g();a(0,"li",8)(1,"a",9),v("click",function(){let p=d(t).$implicit,C=c(2);return f(C.changePage(p))}),l(2),s()()}if(e&2){let t=i.$implicit,r=c(2);R("active",t===r.currentPage),n(2),ce(t)}}function Xe(e,i){if(e&1){let t=g();a(0,"nav",6)(1,"ul",7)(2,"li",8)(3,"a",9),v("click",function(){d(t);let p=c();return f(p.changePage(p.currentPage-1))}),l(4,"prev"),s()(),m(5,We,3,3,"li",10),a(6,"li",8)(7,"a",9),v("click",function(){d(t);let p=c();return f(p.changePage(p.currentPage+1))}),l(8,"next"),s()()()()}if(e&2){let t=c();n(2),R("disabled",t.currentPage===1),n(3),o("ngForOf",t.pages),n(),R("disabled",t.currentPage===t.totalPages)}}var B=class e{constructor(i,t){this.router=i;this.store=t;this.citiesStore$=this.store.select(Ae());this.destroy$=new oe;this.currentPage=1;this.itemsPerPage=5;this.paginatedCities=[];this.totalPages=1;this.pages=[]}ngOnInit(){this.store.dispatch({type:"[City] Get Cities"}),this.assignDetails()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}assignDetails(){this.citiesStore$.pipe(re(this.destroy$)).subscribe(i=>{this.cities=i,this.updatePagination()})}selectCity(i){this.router.navigate(["cities",i])}updatePagination(){this.totalPages=Math.ceil(this.cities.length/this.itemsPerPage),this.paginatedCities=this.cities.slice((this.currentPage-1)*this.itemsPerPage,this.currentPage*this.itemsPerPage),console.log(this.paginatedCities),this.pages=[];for(let i=1;i<=this.totalPages;i++)this.pages.push(i)}changePage(i){i<1||i>this.totalPages||(this.currentPage=i,this.updatePagination())}changeItemsPerPage(i){this.itemsPerPage=i,this.currentPage=1,this.updatePagination()}static{this.\u0275fac=function(t){return new(t||e)(u(x),u(N))}}static{this.\u0275cmp=h({type:e,selectors:[["app-cities"]],standalone:!1,decls:5,vars:2,consts:[[1,"container-fluid","m-3"],[1,"d-flex","flex-column","align-items-center"],["class","mb-3 w-100 w-md-80 w-lg-75",4,"ngFor","ngForOf"],["aria-label","paginator",4,"ngIf"],[1,"mb-3","w-100","w-md-80","w-lg-75"],[1,"profile",3,"click"],["aria-label","paginator"],[1,"pagination","justify-content-center","mt-4"],[1,"page-item"],[1,"page-link",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"]],template:function(t,r){t&1&&(a(0,"body")(1,"div",0)(2,"div",1),m(3,Qe,3,1,"div",2)(4,Xe,9,5,"nav",3),s()()()),t&2&&(n(3),o("ngForOf",r.paginatedCities),n(),o("ngIf",r.paginatedCities.length>=5))},dependencies:[D,F],styles:["body[_ngcontent-%COMP%]{min-height:100vh;width:100%;background-image:url(/assets/png/castle.png);background-blend-mode:overlay;background-size:43vw 40vw;background-repeat:no-repeat;background-attachment:fixed;background-position:center;background-position-y:80%}.profile[_ngcontent-%COMP%]{display:inline-flex;justify-content:space-evenly;border-style:solid;border-radius:15%;border-color:#3b3b04;position:relative;left:15%;width:70%;font-family:white_storm;font-size:4vw;color:#000;box-shadow:0 8px 16px #dbcca3;background-color:#d0cab8;opacity:.7}.profile[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#c6ba98}.pagination[_ngcontent-%COMP%]{font-family:white_storm;font-size:4vw!important}ul.pagination[_ngcontent-%COMP%]   li.page-item[_ngcontent-%COMP%]   a.page-link[_ngcontent-%COMP%]{font-size:3vw!important}.page-item[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#a09782;color:#333;border:1px solid #ccc;transition:all .3s ease}.page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#c6ba98;color:#fff;border-color:#8d8d8d}.page-item.disabled[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#eee;color:#aaa}"]})}};function Ze(e,i){if(e&1&&(_(0,1),P(1,"app-event-profile",3),y()),e&2){let t=i.$implicit;n(),o("eventProfile",t)}}function et(e,i){if(e&1&&(a(0,"div")(1,"div",1),m(2,Ze,2,1,"ng-container",2),s()()),e&2){let t=c();n(2),o("ngForOf",t.events)}}function tt(e,i){if(e&1&&(_(0,1),P(1,"app-event-profile",3),y()),e&2){let t=i.$implicit;n(),o("eventProfile",t)}}function it(e,i){if(e&1&&(a(0,"div")(1,"div",1),m(2,tt,2,1,"ng-container",2),s()()),e&2){let t=c();n(2),o("ngForOf",t.events)}}function nt(e,i){if(e&1&&(a(0,"th",13),l(1),s()),e&2){let t=c().$implicit;w("font-size","3vw")("font-family","white_storm"),n(),b(" ",t.header," ")}}function ot(e,i){if(e&1&&(a(0,"td",14),l(1),s()),e&2){let t=i.$implicit,r=c().$implicit;w("font-size","3vw")("font-family","cardinal"),n(),b(" ",t[r.fieldName]," ")}}function rt(e,i){if(e&1&&(_(0,11),m(1,nt,2,5,"th",7)(2,ot,2,5,"td",12),y()),e&2){let t=i.$implicit;o("matColumnDef",t.fieldName)}}function at(e,i){e&1&&(a(0,"th",13),l(1," Actions "),s()),e&2&&w("font-size","3vw")("font-family","white_storm")}function st(e,i){if(e&1){let t=g();a(0,"td",14)(1,"button",15),v("click",function(){let p=d(t).$implicit,C=c(2);return f(C.selectEvent(p,0))}),l(2," View "),s()()}e&2&&(n(),w("font-size","3vw")("font-family","cardinal"))}function ct(e,i){e&1&&P(0,"tr",16)}function pt(e,i){e&1&&P(0,"tr",17)}function mt(e,i){if(e&1&&(a(0,"div")(1,"table",4),m(2,rt,3,1,"ng-container",5),_(3,6),m(4,at,2,4,"th",7)(5,st,3,4,"td",8),y(),m(6,ct,1,0,"tr",9)(7,pt,1,0,"tr",10),s()()),e&2){let t=c();n(),o("dataSource",t.events),n(),o("ngForOf",t.headers),n(4),o("matHeaderRowDef",t.eventNamesFields),n(),o("matRowDefColumns",t.eventNamesFields)}}var V=class e{constructor(){this.headers=[];this.events=[];this.event=new se;this.eventNamesFields=[]}ngOnInit(){this.getHeaderFields()}getHeaderFields(){this.eventNamesFields=this.headers.map(i=>i.fieldName),this.eventNamesFields.push("actions")}selectEvent(i,t){this.event.emit({event:i,action:t})}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275cmp=h({type:e,selectors:[["app-events-by-city"]],inputs:{headers:"headers",events:"events"},outputs:{event:"event"},standalone:!1,decls:3,vars:3,consts:[[4,"isGranted"],[1,"eventCont"],["class","eventCont",4,"ngFor","ngForOf"],[3,"eventProfile"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","",3,"font-size","font-family",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["mat-cell","",3,"font-size","font-family",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,r){t&1&&m(0,et,3,1,"div",0)(1,it,3,1,"div",0)(2,mt,8,4,"div",0),t&2&&(o("isGranted","ROLE_USER"),n(),o("isGranted","ROLE_MUTED"),n(),o("isGranted","ROLE_ADMIN"))},dependencies:[Be,Ne,D,xe,we,be,Oe,Ie,Pe,ke,Me,Te,Re,De],styles:[".eventCont[_ngcontent-%COMP%]{padding-top:5%;display:grid;grid-template-rows:12vw 7vw;grid-auto-rows:40px;gap:2vw}"]})}};function dt(e,i){if(e&1){let t=g();_(0),a(1,"app-events-by-city",1),v("event",function(p){d(t);let C=c();return f(C.selectEvent(p))}),s(),y()}if(e&2){let t=i.ngIf,r=c();n(),o("events",t)("headers",r.headers)}}var $=class e{constructor(i,t,r){this.router=i;this.actRouter=t;this.store=r;this.headers=[{header:"eventName",fieldName:"eventName"}];this.events=[];this.cityEvents$=this.store.select(He());this.city=this.actRouter.snapshot.params.city}ngOnInit(){this.store.dispatch({type:"[Event] Get Events",city:this.city})}selectEvent(i){switch(i.action){case 0:{this.router.navigate(["events",i.event.id]);return}}}static{this.\u0275fac=function(t){return new(t||e)(u(x),u(Ce),u(N))}}static{this.\u0275cmp=h({type:e,selectors:[["app-events-by-city-page"]],standalone:!1,decls:3,vars:3,consts:[[4,"ngIf"],[3,"event","events","headers"]],template:function(t,r){t&1&&(a(0,"body"),m(1,dt,2,2,"ng-container",0),pe(2,"async"),s()),t&2&&(n(),o("ngIf",me(2,1,r.cityEvents$)))},dependencies:[F,V,le],styles:["body[_ngcontent-%COMP%]{min-height:100vh;width:100%;background-image:url(/assets/png/castle.png);background-blend-mode:overlay;background-size:43vw 40vw;background-repeat:no-repeat;background-attachment:fixed;background-position:center;background-position-y:80%}"]})}};var ne=[{path:"",children:[{path:"",component:B},{path:":city",component:$}]}],j=class e{static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275mod=k({type:e})}static{this.\u0275inj=T({imports:[K.forChild(ne),K]})}};var ft={cities:[],events:[]},Je=he(ft,X($e,(e,{cities:i})=>z(H({},e),{cities:i})),X(je,(e,{events:i})=>z(H({},e),{events:i})));var G=class e{constructor(i){this.http=i}getCities(){return this.http.get(`${Z.citiesURL}`).pipe(q(i=>i),E(i=>L(()=>i)))}getEventsByCity(i){return this.http.get(`${Z.citiesURL}/${i.city}`).pipe(q(t=>t),E(t=>L(()=>t)))}static{this.\u0275fac=function(t){return new(t||e)(ae(fe))}}static{this.\u0275prov=M({token:e,factory:e.\u0275fac,providedIn:"root"})}};var A=class e{constructor(){this.actions$=O(Se);this.citiesService=O(G);this.router=O(x);this.getCities$=ee(()=>this.actions$.pipe(te("[City] Get Cities"),Y(()=>this.citiesService.getCities().pipe(J(i=>({type:"[City] Set Cities",cities:i})),E(()=>U)))),{dispatch:!0});this.getEventsByCities$=ee(()=>this.actions$.pipe(te("[Event] Get Events"),Y(i=>this.citiesService.getEventsByCity(i).pipe(J(t=>({type:"[Event] Set Events",events:t})),E(()=>U)))),{dispatch:!0})}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275prov=M({token:e,factory:e.\u0275fac})}};var Ye=class e{static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275mod=k({type:e})}static{this.\u0275inj=T({providers:[ue(ne,_e()),ve()],imports:[Ve,de,j,ge,Fe,Ee.forFeature("citiesState",Je),ie.forFeature([A]),ie.forRoot([])]})}};export{Ye as CitiesModule};
