import{a as F,c as x,d as q,e as G}from"./chunk-NXUIEXRU.js";import{a as D}from"./chunk-7JXI2CAY.js";import{a as $,b as L,c as N,d as w}from"./chunk-KY7KR6J2.js";import{a as I}from"./chunk-ONP5GMX3.js";import{a as b}from"./chunk-NAJAWU72.js";import{s as _}from"./chunk-MX3EZ4PD.js";import"./chunk-PDR5UM57.js";import{a as r,b as J,c as i,d as g}from"./chunk-PLDY3HMN.js";import{A as O,o as M,p as T,y as C,z as c}from"./chunk-ERJNKWX5.js";import{$ as U,D as p,Ta as h,X as d,a,aa as l,b as s,ca as j,da as m,ec as A,f as u,k as v,n as E,qc as k,t as f,v as n,vc as S}from"./chunk-V72LI5IB.js";var Y=[{path:"login",component:q},{path:"join",component:F},{path:"home/settings",component:G}],R=class e{static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275mod=h({type:e})}static{this.\u0275inj=l({imports:[S.forChild(Y),S]})}};var P={jwtToken:"",user:{id:0,username:"",email:"",city:"",about:"",eventsAmount:0,role:""},error:null},B=O(P,c(L,(e,{jwtToken:o})=>s(a({},e),{jwtToken:o})),c(N,(e,{error:o})=>s(a({},e),{error:o})),c($,(e,{user:o})=>s(a({},e),{user:o})),c(w,()=>a({},P)));var y=class e{constructor(o){this.dataService=o;this.actions$=m(J);this.authService=m(x);this.router=m(k);this.userSubject=new v(null);this.cookieService=m(b);this.loginUser$=r(()=>this.actions$.pipe(i("[AUTH] Login"),n(o=>this.authService.login(o.payload).pipe(f(t=>({type:"[AUTH] Set Token",jwtToken:t.token})),d(()=>this.router.navigate(["home"])),p(t=>u(this,null,function*(){return{type:"[AUTH] LOGIN_ERROR",error:t.error}}))))),{dispatch:!0});this.createUser$=r(()=>this.actions$.pipe(i("[AUTH] Create User"),n(o=>this.authService.join(o.payload).pipe(f(t=>({type:"[AUTH] Set Token",jwtToken:t.token})),d(()=>this.router.navigate(["/"])),p(t=>u(this,null,function*(){return{type:"[AUTH] LOGIN_ERROR",error:t.error}}))))),{dispatch:!0});this.getUser$=r(()=>this.actions$.pipe(i("[AUTH] Get User"),n(o=>this.authService.getUser().pipe(f(t=>({type:"[AUTH] Set User",user:t})),p(()=>E)))),{dispatch:!0});this.updateUser$=r(()=>(console.log("update"),this.actions$.pipe(i("[AUTH] Update"),n(o=>this.authService.update(o.payload).pipe(p(t=>u(this,null,function*(){return{type:"[AUTH] LOGIN_ERROR",error:t.error}})))))),{dispatch:!1});this.logout$=r(()=>this.actions$.pipe(i("[AUTH] Logout"),d(()=>{localStorage.clear(),this.cookieService.deleteAll()})),{dispatch:!1})}static{this.\u0275fac=function(t){return new(t||e)(j(I))}}static{this.\u0275prov=U({token:e,factory:e.\u0275fac})}};function z(e){return D({keys:["jwtToken"]})(e)}var Q=[z],H=class e{static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275mod=h({type:e})}static{this.\u0275inj=l({imports:[A,R,M,T,_,C.forFeature("authState",B,{metaReducers:Q}),g.forFeature([y]),g.forRoot([])]})}};export{H as AuthModule,z as localStorageSyncReducer};
